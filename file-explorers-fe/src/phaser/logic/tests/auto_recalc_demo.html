<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Recalculation Demo</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #4ec9b0;
        }
        .control-panel {
            background: #252526;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .status {
            background: #2d2d30;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .status-item {
            margin: 8px 0;
        }
        .component-editor {
            background: #252526;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        button {
            background: #0e639c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 3px;
            cursor: pointer;
            margin-right: 10px;
            font-size: 14px;
        }
        button:hover {
            background: #1177bb;
        }
        button.danger {
            background: #c5423b;
        }
        button.danger:hover {
            background: #e74c3c;
        }
        button.success {
            background: #3a7d34;
        }
        button.success:hover {
            background: #4ec9b0;
        }
        input[type="number"], select {
            background: #3c3c3c;
            border: 1px solid #555;
            color: #d4d4d4;
            padding: 8px;
            border-radius: 3px;
            margin: 5px;
        }
        .log {
            background: #1e1e1e;
            border: 1px solid #3c3c3c;
            padding: 15px;
            border-radius: 3px;
            height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .log-entry {
            margin: 3px 0;
            padding: 3px;
        }
        .log-info { color: #4ec9b0; }
        .log-warn { color: #dcdcaa; }
        .log-error { color: #f48771; }
        .indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .indicator.active { background: #4ec9b0; }
        .indicator.inactive { background: #666; }
    </style>
</head>
<body>
    <h1>‚ö° Circuit Simulator - Auto-Recalculation Demo</h1>

    <div class="control-panel">
        <h2>Simulation Controls</h2>
        <button onclick="startAutoRecalc()" class="success">‚ñ∂ Start Auto-Recalculation</button>
        <button onclick="stopAutoRecalc()" class="danger">‚èπ Stop Auto-Recalculation</button>
        <button onclick="manualRecalc()">üîÑ Manual Recalculate</button>
        <button onclick="clearLog()">üóë Clear Log</button>
        <br><br>
        <label>
            Interval (ms): 
            <input type="number" id="interval" value="1000" min="100" max="5000" step="100">
        </label>
    </div>

    <div class="status">
        <h2>Status</h2>
        <div class="status-item">
            <span class="indicator" id="autoRecalcIndicator"></span>
            <strong>Auto-Recalculation:</strong> <span id="autoRecalcStatus">Stopped</span>
        </div>
        <div class="status-item">
            <strong>Components:</strong> <span id="componentCount">0</span>
        </div>
        <div class="status-item">
            <strong>Active Paths:</strong> <span id="pathCount">0</span>
        </div>
        <div class="status-item">
            <strong>Last Update:</strong> <span id="lastUpdate">Never</span>
        </div>
        <div class="status-item">
            <strong>Update Count:</strong> <span id="updateCount">0</span>
        </div>
    </div>

    <div class="component-editor">
        <h2>Simulate Value Changes</h2>
        <p>Change these values to trigger recalculation:</p>
        <div>
            <label>Voltage: <input type="number" id="voltageInput" value="24" step="1"> V</label>
            <button onclick="changeVoltage()">Apply</button>
        </div>
        <div>
            <label>Resistance: <input type="number" id="resistanceInput" value="100" step="10"> Œ©</label>
            <button onclick="changeResistance()">Apply</button>
        </div>
        <div>
            <label>Current: <input type="number" id="currentInput" value="0.04" step="0.01"> A</label>
            <button onclick="changeCurrent()">Apply</button>
        </div>
    </div>

    <div>
        <h2>Console Log</h2>
        <div class="log" id="logArea"></div>
    </div>

    <script>
        // Mock circuit simulator
        let updateCounter = 0;
        let autoRecalcInterval = null;
        let simulationRunning = false;

        // Mock component state
        let mockComponents = {
            voltage: 24,
            resistance: 100,
            current: 0.04
        };

        function log(message, type = 'info') {
            const logArea = document.getElementById('logArea');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `[${timestamp}] ${message}`;
            logArea.appendChild(entry);
            logArea.scrollTop = logArea.scrollHeight;
        }

        function updateStatus() {
            const indicator = document.getElementById('autoRecalcIndicator');
            indicator.className = `indicator ${simulationRunning ? 'active' : 'inactive'}`;
            
            document.getElementById('autoRecalcStatus').textContent = simulationRunning ? 'Running' : 'Stopped';
            document.getElementById('componentCount').textContent = '3'; // Mock
            document.getElementById('pathCount').textContent = '1'; // Mock
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
            document.getElementById('updateCount').textContent = updateCounter;
        }

        function runCalculation() {
            updateCounter++;
            const power = mockComponents.voltage * mockComponents.current;
            const calculatedR = mockComponents.voltage / mockComponents.current;
            
            log(`üîÑ Recalculation #${updateCounter}`, 'info');
            log(`   V=${mockComponents.voltage}V, I=${mockComponents.current}A, R=${mockComponents.resistance}Œ©`, 'info');
            log(`   Calculated: P=${power.toFixed(2)}W, R=${calculatedR.toFixed(2)}Œ©`, 'info');
            
            updateStatus();
        }

        function startAutoRecalc() {
            if (simulationRunning) {
                log('‚ö† Auto-recalculation already running', 'warn');
                return;
            }

            const interval = parseInt(document.getElementById('interval').value);
            simulationRunning = true;
            
            log(`‚ñ∂ Starting auto-recalculation (every ${interval}ms)`, 'info');
            
            autoRecalcInterval = setInterval(() => {
                runCalculation();
            }, interval);
            
            updateStatus();
        }

        function stopAutoRecalc() {
            if (!simulationRunning) {
                log('‚ö† Auto-recalculation not running', 'warn');
                return;
            }

            clearInterval(autoRecalcInterval);
            autoRecalcInterval = null;
            simulationRunning = false;
            
            log('‚èπ Auto-recalculation stopped', 'info');
            updateStatus();
        }

        function manualRecalc() {
            log('üîÑ Manual recalculation triggered', 'info');
            runCalculation();
        }

        function changeVoltage() {
            const newValue = parseFloat(document.getElementById('voltageInput').value);
            mockComponents.voltage = newValue;
            log(`üìù Voltage changed to ${newValue}V`, 'info');
            
            if (simulationRunning) {
                log('   Auto-recalculation will update soon...', 'info');
            } else {
                manualRecalc();
            }
        }

        function changeResistance() {
            const newValue = parseFloat(document.getElementById('resistanceInput').value);
            mockComponents.resistance = newValue;
            log(`üìù Resistance changed to ${newValue}Œ©`, 'info');
            
            if (simulationRunning) {
                log('   Auto-recalculation will update soon...', 'info');
            } else {
                manualRecalc();
            }
        }

        function changeCurrent() {
            const newValue = parseFloat(document.getElementById('currentInput').value);
            mockComponents.current = newValue;
            log(`üìù Current changed to ${newValue}A`, 'info');
            
            if (simulationRunning) {
                log('   Auto-recalculation will update soon...', 'info');
            } else {
                manualRecalc();
            }
        }

        function clearLog() {
            document.getElementById('logArea').innerHTML = '';
            log('üóë Log cleared', 'info');
        }

        // Initialize
        log('‚úì Auto-recalculation demo initialized', 'info');
        log('üí° Click "Start Auto-Recalculation" to begin automatic updates', 'info');
        log('üí° Change component values to see recalculation in action', 'info');
        updateStatus();
    </script>
</body>
</html>
